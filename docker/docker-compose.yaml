services:
  v4f:
    image: ivukotic/v4a:frontier-no-snmp
    container_name: v4f
    environment:
      SITE: "<SITENAME>"
      INSTANCE: "<INSTANCE>"
      VARNISH_PORT: "8080"
      VARNISH_MEM: "32G"
      VARNISH_TRANSIENT_MEM: "2G"
    ports:
      - "6082:8080"
    volumes:
      - ./vcl/default.vcl:/etc/varnish/default.vcl:ro
    deploy:
      resources:
        limits:
          cpus: "6.0"
          memory: 64G
        reservations:
          cpus: "2.0"
          memory: 12G
    healthcheck:
      test: ["CMD", "/usr/local/bin/sender.sh"]
      interval: 5s
      timeout: 4s
      start_period: 120s
      retries: 3
